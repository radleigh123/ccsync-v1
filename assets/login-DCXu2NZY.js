import{s as l,a as d,b as a,g as u,c as m}from"./core-inoSP3gc.js";import"./data-CZaJBQaZ.js";l(a,m).catch(t=>{console.error("Error setting persistence:",t)});async function h(){await u()&&(window.location.href="/ccsync-v1/pages/home/home.html")}document.addEventListener("DOMContentLoaded",()=>{h();const t=document.querySelector("#login-form"),o=document.querySelector("#error-msg");t.addEventListener("submit",async r=>{r.preventDefault();const i=document.querySelector("#emailInput").value,c=document.querySelector("#passwordInput").value;try{let n=null;d(a,i,c).then(async e=>(n=await e.user.getIdToken(),n)).then(e=>fetch("http://localhost:8000/api/auth/verify-token",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id_token:e})})).then(e=>e.json()).then(e=>{console.log("Verified user: ",e);const s={...e.user,firebase_token:n,last_login:new Date().toISOString()};localStorage.setItem("user",JSON.stringify(s)),window.location.href="/ccsync-v1/pages/home/home.html"}).catch(e=>{const s=e.code;o.textContent=e.message,console.error("Error during token verification: ",e)})}catch(n){o.textContent=n.message,console.error("Error during login: ",n)}})});(()=>{const t=document.querySelectorAll(".needs-validation");Array.from(t).forEach(o=>{o.addEventListener("submit",r=>{o.checkValidity()||(r.preventDefault(),r.stopPropagation()),o.classList.add("was-validated")},!1)})})();
